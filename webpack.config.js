// WordPress webpack config.
const defaultConfig = require('@wordpress/scripts/config/webpack.config');

// Plugins.
const RemoveEmptyScriptsPlugin = require('webpack-remove-empty-scripts');

// Utilities.
const path = require('path');

// Add any new entry points by extending the webpack config.
module.exports = {
	...defaultConfig,
	...{
		entry: {
			'chocante': path.resolve(process.cwd(), 'styles', 'theme.scss'),
			'chocante-scripts': path.resolve(process.cwd(), 'scripts', 'theme.js'),
			'product-section': path.resolve(process.cwd(), 'scripts', 'product-section.js'),
			'cart': path.resolve(process.cwd(), 'styles', 'cart.scss'),
			'cart-scripts': path.resolve(process.cwd(), 'scripts', 'cart.js'),
			'single-product': path.resolve(process.cwd(), 'styles', 'single-product.scss'),
			'single-product-scripts': path.resolve(process.cwd(), 'scripts', 'single-product.js'),
			'shop': path.resolve(process.cwd(), 'styles', 'shop.scss'),
			'shop-scripts': path.resolve(process.cwd(), 'scripts', 'shop.js'),
			'account': path.resolve(process.cwd(), 'styles', 'account.scss'),
			'account-scripts': path.resolve(process.cwd(), 'scripts', 'account.js'),
			'blog': path.resolve(process.cwd(), 'styles', 'blog.scss'),
			'checkout': path.resolve(process.cwd(), 'styles', 'checkout.scss'),
			'editor': path.resolve(process.cwd(), 'styles', 'editor.scss'),
			'editor-scripts': path.resolve(process.cwd(), 'scripts', 'editor.js'),
			'single-post': path.resolve(process.cwd(), 'styles', 'single-post.scss'),
		},
		plugins: [
			// Include WP's plugin config.
			...defaultConfig.plugins,

			// Removes the empty `.js` files generated by webpack but
			// sets it after WP has generated its `*.asset.php` file.
			new RemoveEmptyScriptsPlugin({
				stage: RemoveEmptyScriptsPlugin.STAGE_AFTER_PROCESS_PLUGINS
			})
		],
		stats: {
			warnings: false
		}
	}
};